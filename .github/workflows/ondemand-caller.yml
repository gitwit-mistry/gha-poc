name: ON Demand Caller
on: 
  workflow_dispatch:
    inputs:
      branch:
          description: "Development Branch"
          required: true
          type: string
          default: ''

defaults:
  run:
    shell: bash

# jobs:
#   create:
#     runs-on: ubuntu-latest
#     outputs:
#       output1: ${{ env.timestamp }}
#     steps:
#       - name: Get current date
#         id: date
#         run: echo "timestamp=$(TZ='Asia/Kolkata' date +'%Y%m%d%H%M')" >> $GITHUB_ENV

          
#   validate:
#     runs-on: ubuntu-latest
#     needs: create
#     env:
#       OUTPUT1: ${{needs.create.outputs.output1}}
#     steps:
#       - name: env-val
#         run: echo $OUTPUT1
 
jobs:
  create:
    runs-on: ubuntu-latest
    outputs:
      output1: ${{ steps.date.outputs.branch}}
    env:
      BRANCH: ${{ inputs.branch }}
    steps:
      - name: Get current date
        id: date
        run: echo "branch=$BRANCH" >> $GITHUB_OUTPUT

          
#   validate:
#     runs-on: ubuntu-latest
#     needs: create
#     env:
#       OUTPUT1: ${{needs.create.outputs.output1}}
#     steps:
#       - name: env-val
#         run: echo $OUTPUT1
         
          
          
  use:
   uses: gitwit-mistry/gha-poc/.github/workflows/envtest.yml@main
   needs: create
   with:
     branch: ${{ needs.create.outputs.output1 }}
   secrets: inherit
